#pragma checksum "C:\Users\milto\Documents\prueba tecnica\Nueva carpeta\PruebaTecnica\PruebaTecnica.AplicacionWeb\Views\Producto\Index.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "ac5db2fd00009d10704c782077f0b01cc3107861"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Views_Producto_Index), @"mvc.1.0.view", @"/Views/Producto/Index.cshtml")]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
#nullable restore
#line 1 "C:\Users\milto\Documents\prueba tecnica\Nueva carpeta\PruebaTecnica\PruebaTecnica.AplicacionWeb\Views\_ViewImports.cshtml"
using PruebaTecnica.AplicacionWeb;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\milto\Documents\prueba tecnica\Nueva carpeta\PruebaTecnica\PruebaTecnica.AplicacionWeb\Views\_ViewImports.cshtml"
using PruebaTecnica.AplicacionWeb.Models;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"ac5db2fd00009d10704c782077f0b01cc3107861", @"/Views/Producto/Index.cshtml")]
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"a4f9fcc1439f9aa674a8dd64e151e43eea62aa58", @"/Views/_ViewImports.cshtml")]
    #nullable restore
    public class Views_Producto_Index : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<dynamic>
    #nullable disable
    {
        private static readonly global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute __tagHelperAttribute_0 = new global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute("class", new global::Microsoft.AspNetCore.Html.HtmlString("d-flex"), global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.DoubleQuotes);
        private static readonly global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute __tagHelperAttribute_1 = new global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute("role", new global::Microsoft.AspNetCore.Html.HtmlString("search"), global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.DoubleQuotes);
        private static readonly global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute __tagHelperAttribute_2 = new global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute("value", "", global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.DoubleQuotes);
        #line hidden
        #pragma warning disable 0649
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext __tagHelperExecutionContext;
        #pragma warning restore 0649
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner __tagHelperRunner = new global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner();
        #pragma warning disable 0169
        private string __tagHelperStringValueBuffer;
        #pragma warning restore 0169
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager __backed__tagHelperScopeManager = null;
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager __tagHelperScopeManager
        {
            get
            {
                if (__backed__tagHelperScopeManager == null)
                {
                    __backed__tagHelperScopeManager = new global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager(StartTagHelperWritingScope, EndTagHelperWritingScope);
                }
                return __backed__tagHelperScopeManager;
            }
        }
        private global::Microsoft.AspNetCore.Mvc.TagHelpers.FormTagHelper __Microsoft_AspNetCore_Mvc_TagHelpers_FormTagHelper;
        private global::Microsoft.AspNetCore.Mvc.TagHelpers.RenderAtEndOfFormTagHelper __Microsoft_AspNetCore_Mvc_TagHelpers_RenderAtEndOfFormTagHelper;
        private global::Microsoft.AspNetCore.Mvc.TagHelpers.OptionTagHelper __Microsoft_AspNetCore_Mvc_TagHelpers_OptionTagHelper;
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
#nullable restore
#line 4 "C:\Users\milto\Documents\prueba tecnica\Nueva carpeta\PruebaTecnica\PruebaTecnica.AplicacionWeb\Views\Producto\Index.cshtml"
  
    ViewData["Title"] = "Product Page";

#line default
#line hidden
#nullable disable
            WriteLiteral("\r\n<div class=\"row\">\r\n    <div class=\"col-sm-12\">\r\n\r\n        <!--Inicio tarjeta-->\r\n\r\n        <div class=\"card\">\r\n            <div class=\"card-header\">Productos</div>\r\n            <div class=\"card-body\">\r\n                ");
            __tagHelperExecutionContext = __tagHelperScopeManager.Begin("form", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.StartTagAndEndTag, "ac5db2fd00009d10704c782077f0b01cc31078615043", async() => {
                WriteLiteral("\r\n                    <input class=\"form-control me-2\" type=\"search\" placeholder=\"Search\" aria-label=\"Search\">\r\n                    <button class=\"btn btn-outline-success\" type=\"submit\">Search</button>\r\n                ");
            }
            );
            __Microsoft_AspNetCore_Mvc_TagHelpers_FormTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.TagHelpers.FormTagHelper>();
            __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_TagHelpers_FormTagHelper);
            __Microsoft_AspNetCore_Mvc_TagHelpers_RenderAtEndOfFormTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.TagHelpers.RenderAtEndOfFormTagHelper>();
            __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_TagHelpers_RenderAtEndOfFormTagHelper);
            __tagHelperExecutionContext.AddHtmlAttribute(__tagHelperAttribute_0);
            __tagHelperExecutionContext.AddHtmlAttribute(__tagHelperAttribute_1);
            await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
            if (!__tagHelperExecutionContext.Output.IsContentModified)
            {
                await __tagHelperExecutionContext.SetOutputContentAsync();
            }
            Write(__tagHelperExecutionContext.Output);
            __tagHelperExecutionContext = __tagHelperScopeManager.End();
            WriteLiteral(@"

                <hr />

                <button class=""btn btn-success"" id=""btnNuevo"">Nuevo Producto</button>
                

                <hr />

                <table class=""table table-striped"" id=""tbProducto"">
                    <thead>
                        <tr>
                            <th>Codigo Producto</th>
                            <th>Descripcion Producto</th>
                            <th>Estado Producto</th>
                            <th>Fecha Fabricacion</th>
                            <th>Fecha Validez</th>
                            <th>Codigo Proveedor</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>

            </div>
        </div>
        <!--Fin tarjeta-->

    </div>
</div>


<!-- Inicio Modal --> 

<div class=""modal"" tabindex=""-1"">
    <div class=""modal-dialog"">
        <div class=""modal-content");
            WriteLiteral(@""">
            <div class=""modal-header"">
                <h5 class=""modal-title"">Detalle Producto</h5>
                <button type=""button"" class=""btn-close"" data-dismiss=""modal"" aria-label=""Close""></button>
            </div>
            <div class=""modal-body"">
                <input type=""hidden"" id=""txtCodigoProducto"" value=""0"" />
                <div class=""mb-2"">
                    <label>Descripcion Producto</label>
                    <input type=""text"" class=""form-control"" id=""txtDescipcionProducto"" />
                </div>
                <div class=""mb-2"">
                    <label>Estado Producto</label>
                    <select class=""form-select"" id=""txtEstadoProducto"" required>
                      ");
            __tagHelperExecutionContext = __tagHelperScopeManager.Begin("option", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.StartTagAndEndTag, "ac5db2fd00009d10704c782077f0b01cc31078618522", async() => {
                WriteLiteral("Seleccione un estado");
            }
            );
            __Microsoft_AspNetCore_Mvc_TagHelpers_OptionTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.TagHelpers.OptionTagHelper>();
            __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_TagHelpers_OptionTagHelper);
            BeginWriteTagHelperAttribute();
            __tagHelperStringValueBuffer = EndWriteTagHelperAttribute();
            __tagHelperExecutionContext.AddHtmlAttribute("selected", Html.Raw(__tagHelperStringValueBuffer), global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.Minimized);
            BeginWriteTagHelperAttribute();
            __tagHelperStringValueBuffer = EndWriteTagHelperAttribute();
            __tagHelperExecutionContext.AddHtmlAttribute("disabled", Html.Raw(__tagHelperStringValueBuffer), global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.Minimized);
            __Microsoft_AspNetCore_Mvc_TagHelpers_OptionTagHelper.Value = (string)__tagHelperAttribute_2.Value;
            __tagHelperExecutionContext.AddTagHelperAttribute(__tagHelperAttribute_2);
            await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
            if (!__tagHelperExecutionContext.Output.IsContentModified)
            {
                await __tagHelperExecutionContext.SetOutputContentAsync();
            }
            Write(__tagHelperExecutionContext.Output);
            __tagHelperExecutionContext = __tagHelperScopeManager.End();
            WriteLiteral("\r\n                      ");
            __tagHelperExecutionContext = __tagHelperScopeManager.Begin("option", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.StartTagAndEndTag, "ac5db2fd00009d10704c782077f0b01cc310786110339", async() => {
                WriteLiteral("Activo");
            }
            );
            __Microsoft_AspNetCore_Mvc_TagHelpers_OptionTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.TagHelpers.OptionTagHelper>();
            __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_TagHelpers_OptionTagHelper);
            await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
            if (!__tagHelperExecutionContext.Output.IsContentModified)
            {
                await __tagHelperExecutionContext.SetOutputContentAsync();
            }
            Write(__tagHelperExecutionContext.Output);
            __tagHelperExecutionContext = __tagHelperScopeManager.End();
            WriteLiteral("\r\n                      ");
            __tagHelperExecutionContext = __tagHelperScopeManager.Begin("option", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.StartTagAndEndTag, "ac5db2fd00009d10704c782077f0b01cc310786111320", async() => {
                WriteLiteral("Inactivo");
            }
            );
            __Microsoft_AspNetCore_Mvc_TagHelpers_OptionTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.TagHelpers.OptionTagHelper>();
            __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_TagHelpers_OptionTagHelper);
            await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
            if (!__tagHelperExecutionContext.Output.IsContentModified)
            {
                await __tagHelperExecutionContext.SetOutputContentAsync();
            }
            Write(__tagHelperExecutionContext.Output);
            __tagHelperExecutionContext = __tagHelperScopeManager.End();
            WriteLiteral(@"
                    </select>
                </div>
                <div class=""mb-2"">
                    <label>Fecha Fabricacion</label>
                    <input type=""text"" class=""form-control"" id=""txtFechaFabricacion"" />
                </div>
                <div class=""mb-2"">
                    <label>Fecha Validez</label>
                    <input type=""text"" class=""form-control"" id=""txtFechaValidez"" />
                </div>
                <div class=""mb-2"">
                    <label>Codigo Proveedor</label>
                    <input type=""text"" class=""form-control"" id=""txtcodigoProveedorID"" />
                </div>
            </div>
            <div class=""modal-footer"">
                <button type=""button"" class=""btn btn-primary"" id=""btnGuardar"">Guardar</button>
                <button type=""button"" class=""btn btn-secondary"" data-dismiss=""modal"" aria-label=""Close"">Cerrar</button>
            </div>
        </div>
    </div>
</div>

<!--Fin Modal-->

");
            DefineSection("Scripts", async() => {
                WriteLiteral(@" 
    <script>


        const Modelo_base = {
            codigoProducto: 0,
            descripcionProducto: """",
            estadoProducto: """",
            fechaFabricacion: """",
            fechaValidez: """",
            codigoProveedorId: """"
        }

        $(document).ready(() =>{
            listaProductos();
        })

        function mostrarModal(modelo) {

            $(""#txtCodigoProducto"").val(modelo.codigoProducto);
            $(""#txtDescipcionProducto"").val(modelo.descripcionProducto);
            $(""#txtEstadoProducto"").val(modelo.estadoProducto);
            $(""#txtFechaFabricacion"").val(modelo.fechaFabricacion);
            $(""#txtFechaValidez"").val(modelo.fechaValidez);
            $(""#txtcodigoProveedorID"").val(modelo.codigoProveedorId);

            $('.modal').modal('show');
        }

        $(""#btnNuevo"").click(() => {

            mostrarModal(Modelo_base);
        })

        $(""#btnGuardar"").click(() => {

            let NuevoModelo = Modelo_");
                WriteLiteral(@"base;

            if( $(""#txtFechaFabricacion"").val() < $(""#txtFechaValidez"").val()){

            NuevoModelo[""codigoProducto""] = $(""#txtCodigoProducto"").val();
            NuevoModelo[""descripcionProducto""] = $(""#txtDescipcionProducto"").val();
            NuevoModelo[""estadoProducto""] = $(""#txtEstadoProducto"").val();
            NuevoModelo[""fechaFabricacion""] = $(""#txtFechaFabricacion"").val();
            NuevoModelo[""fechaValidez""] = $(""#txtFechaValidez"").val();
            NuevoModelo[""codigoProveedorId""] = $(""#txtcodigoProveedorID"").val();

            if($(""#txtCodigoProducto"").val() == ""0""){

                    fetch(""Producto/Insertar"", {
                        method: ""POST"",
                        headers: {
                            'Content-Type':'application/json;charset=utf-8'
                        },
                        body: JSON.stringify( NuevoModelo)
                    
                    })
                    .then((response) => {

                   ");
                WriteLiteral(@"     return response.ok ? response.json() : Promise.reject(response)
                    })
                    .then ((dataJson) => {
                        if(dataJson.valor){
                            alert(""Registrado"");
                            $('.modal').modal('hide');
                            listaProductos();
                        }
                    })
                }else{
                    if($(""#txtFechaFabricacion"").val() < $(""#txtFechaValidez"").val()){
                    fetch(""Producto/Actualizar"", {
                        method: ""PUT"",
                        headers: {
                            'Content-Type':'application/json;charset=utf-8'
                        },
                        body: JSON.stringify( NuevoModelo)
                    
                    })
                    .then((response) => {

                        return response.ok ? response.json() : Promise.reject(response)
                    })
                    .then ((");
                WriteLiteral(@"dataJson) => {

                        if(dataJson.valor){
                            alert(""Editado"");
                            $('.modal').modal('hide');
                            listaProductos();
                        }
                    })
                    }else{
                        alert(""La fecha de fabricacion no debe ser mayor o igual a la fecha de vencimiento"");
                    }
                }
            }else{
                alert(""La fecha de fabricacion no debe ser mayor o igual a la fecha de vencimiento"");
            }

        })

        function listaProductos(){
            fetch(""Producto/Lista"")
                .then((response) => {
                    return response.ok ? response.json() : Promise.reject(response)
                })
                .then ((dataJson) => {
                    console.log(dataJson)
                    $(""#tbProducto tbody"").html("""");

                    dataJson.forEach((item) => {
                   ");
                WriteLiteral(@"     $(""#tbProducto tbody"").append(
                            $(""<tr>"").append(
                                $(""<td>"").text(item.codigoProducto),
                                $(""<td>"").text(item.descripcionProducto),
                                $(""<td>"").text(item.estadoProducto),
                                $(""<td>"").text(item.fechaFabricacion),
                                $(""<td>"").text(item.fechaValidez),
                                $(""<td>"").text(item.codigoProveedorId),
                                $(""<td>"").append(
                                    $(""<button>"").addClass(""btn btn-primary btn-sm me-2 btn-editar"").data(""modelo"",item).text(""Editar""),
                                    $(""<button>"").addClass(""btn btn-danger btn-sm btn-eliminar"").data(""modelo"",item).text(""Eliminar"")
                                )
                            )
                        )
                    })
             })
        }

        $(""#tbProducto tbody"").on(""click""");
                WriteLiteral(@","".btn-editar"", function(){ 
            let producto = $(this).data(""modelo"")
            mostrarModal(producto)
            
        })

        $(""#tbProducto tbody"").on(""click"","".btn-eliminar"", function(){
            let modelo = Modelo_base;
            let producto = $(this).data(""modelo"")
            modelo = producto;
            
                    fetch(""Producto/Eliminar"", {
                        method: ""PUT"",
                        headers: {
                            'Content-Type':'application/json;charset=utf-8'
                        },
                        body: JSON.stringify( producto)
                    
                    })
                    .then((response) => {
                        console.log(response)
                        return response.ok ? response.json() : Promise.reject(response)
                    })
                    .then ((dataJson) => {

                        if(dataJson.valor){
                            alert(""Eliminad");
                WriteLiteral(@"o"");
                            $('.modal').modal('hide');
                            listaProductos();
                        }
                    })

        })


        //$(""#tbProducto tbody"").on(""click"","".btn-eliminar"", function(){

        //    let producto = $(this).data(""modelo"")

        //    producto[""codigoProducto""] = $(""#txtCodigoProducto"").val();
        //    producto[""descripcionProducto""] = $(""#txtDescipcionProducto"").val();
        //    producto[""estadoProducto""] = $(""#txtEstadoProducto"").val();
        //    producto[""fechaFabricacion""] = $(""#txtFechaFabricacion"").val();
        //    producto[""fechaValidez""] = $(""#txtFechaValidez"").val();
        //    producto[""codigoProveedorId""] = $(""#txtcodigoProveedorID"").val();

        //    console.log(producto)

        //            fetch(""Producto/Eliminar"")
        //            .then((response) => {
        //                console.log(response)
        //                return response.ok ? response.json() : ");
                WriteLiteral(@"Promise.reject(response)
        //            })
        //            .then ((dataJson) => {
        //                if(dataJson.valor){
        //                    alert(""Eliminado"");
        //                    listaProductos();
        //                }
        //            })
        //})

    </script>

");
            }
            );
        }
        #pragma warning restore 1998
        #nullable restore
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; } = default!;
        #nullable disable
        #nullable restore
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; } = default!;
        #nullable disable
        #nullable restore
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; } = default!;
        #nullable disable
        #nullable restore
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; } = default!;
        #nullable disable
        #nullable restore
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<dynamic> Html { get; private set; } = default!;
        #nullable disable
    }
}
#pragma warning restore 1591
